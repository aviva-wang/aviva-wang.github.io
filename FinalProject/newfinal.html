<html>
 <head>
  <title>Eyes On the Road</title>
  <script src="http://cloud.github.com/downloads/processing-js/processing-js/processing-1.4.1.min.js"></script>
  <script type="text/processing" data-processing-target="mycanvas">
  var roadScroller;
  var sideScroller;	
  PImage c;
  PImage k;
  PImage t1;
  PImage t2;
  PImage t3;
  PImage t4;
  PImage t5;
  PImage t6;
  PImage t7;
  PImage t8;
  PImage t9;
  //controler car
  var controllerX;
  var controllerY;
  //obstacle car
  var obstacleX;
  var obstacleY;
  //text bubble
  var lives;
  void setup(){
   //canvas set up
   size(800,600);
   background(0,0,0);
   // dashes and sidewalk called
   roadScroller = new Road();
   sideScroller = new Side();
   //controler called 
   controllerX = 320;
   controllerY = 375;
   obstacleX = 200;
   obstacleY = 20;
   lives = 3;
   //car images
   c = loadImage("ControlerCar.png");
   k = loadImage("obstacle.png");
   randLanes = [80, 250, 400];    
  //text bubble
	 t1 = loadImage("textingbubble1.png");
	 t2 = loadImage("textingbubble2.png");
	 t3 = loadImage("textingbubble3.png");
	 t4 = loadImage("textingbubble4.png");
	 t5 = loadImage("textingbubble5.png");
	 t6 = loadImage("textingbubble6.png");
	 t7 = loadImage("textingbubble7.png");
	 t8 = loadImage("textingbubble8.png");
	 t9 = loadImage("textingbubble9.png");
	  
  }
  void draw(){ 
   background(0,0,0); 
   roadScroller.drawDashes();
   roadScroller.moveDashes();
   sideScroller.drawSideWalks();
   sideScroller.moveSideWalks();
   fill(64,64,64);
   rect(0,0,3,600);
   rect(797, 0, 3, 600);
   rect(150, 0, 3, 600);
   rect(650, 0, 3, 600);
   image(k, obstacleX, obstacleY, 360, 250);
   image(c, controllerX, controllerY, 175, 250);
    // image(t1, 100, 100, 600, 300);
   //image(t2, 100, 100, 600, 300);
 //image(t3, 100, 100, 600, 300);
 //image(t4, 100, 100, 600, 300);
 //image(t5, 100, 100, 600, 300);
 //image(t6, 100, 100, 600, 300);
 //image(t7, 100, 100, 600, 300);
 //image(t8, 100, 100, 600, 300);
 //image(t9, 100, 100, 600, 300);
   
   if (keyPressed == true){
 if (key == CODED) {
  if (keyCode == RIGHT){
   if (controllerX < 530) controllerX += 3;
  }
  else if (keyCode == LEFT){
   if (controllerX > 100) controllerX -= 3;
  }
 }
  }
  if ((obstacleY > controllerY-110 && obstacleY < controllerY+110) && (obstacleX > controllerX-110 && obstacleX < controllerX + 110) && lives>0){
    randomPosition = Math.round(Math.random() * 2);
    obstacleX = randLanes[randomPosition];
 obstacleY = -100;
 lives--;
}
  else if (lives < 1)
  {
 size(800, 600, P3D);
 PFont font;
 font = loadFont("FFScala.ttf"); 
 textFont(font); 
 fill(0, 102, 153);
 text("GAME OVER", 15, 60, -30);
 alert("GAME OVER!");
 document.location.reload;
  }
 if (obstacleY > 700){
    randomPosition = Math.round(Math.random() * 2);
    obstacleX = randLanes[randomPosition];
    obstacleY = -100;
}
  obstacleY += 4;
  }
  
  class Dash {
   var yPosition;
   Dash(y){
    yPosition = y;
   }
   void drawDash(){
    noStroke();
    fill(255,215,0);
    rect(300,yPosition, 5, 15);
 rect(500,yPosition, 5, 15);
   }
   void move(speed){
    yPosition += speed;
   }
  }
  class Road {
   var scrollEndY = 600;
   var dashes = new Array();
   Road(){
    currentHeight = 0;
    while(currentHeight < 600){
     dashes.push(new Dash(currentHeight));
     currentHeight += 20;
    }
    scrollEndY = 600 - currentHeight;
   }
   void drawDashes(){
    for(var i = 0; i < dashes.length; i++){
     dashes[i].drawDash();
    }
   }
   void moveDashes(){
    for(var i = 0; i < dashes.length; i++){
     dashes[i].move(2);
    }
    scrollEndY += 2;
    if(scrollEndY > 5){
     addDash(scrollEndY - 22);
    }
   }
   void addDash(yLocation){
    dashes.push(new Dash(yLocation));
    scrollEndY -= 20;
   }
  }
    class SideWalk {
   var yPos;
   SideWalk(yy){
    yPos = yy;
   }
   void drawSideWalk(){
    noStroke();
    fill(220,220,220);
    rect(0,yPos, 150, 150);
 rect(650,yPos, 150, 150);
   }
   void move(s){
    yPos += s;
   }
  }
  class Side {
   var scrollEndYY = 600;
   var SideWalks = new Array();
   Side(){
   currentHeights = 0;
    while(currentHeights < 600){
     SideWalks.push(new SideWalk(currentHeights));
     currentHeights += 155;
    }
    scrollEndYY = 1000 - currentHeights;
   }
   void drawSideWalks(){
    for(var i = 0; i < SideWalks.length; i++){
     SideWalks[i].drawSideWalk();
    }
   }
   void moveSideWalks(){
    for(var i = 0; i < SideWalks.length; i++){
     SideWalks[i].move(2);
    }
    scrollEndYY += 2;
    if(scrollEndYY > 5){
     addSideWalk(scrollEndYY - 200);
    }
   }
   void addSideWalk(yLoc){
    SideWalks.push(new SideWalk(yLoc));
    scrollEndYY -= 151;
   }
  }
  
  </script>
 </head>
 <body>
  <canvas id="mycanvas"></canvas>
 </body>
</html>